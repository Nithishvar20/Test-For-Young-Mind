import{r as a,j as e}from"./index-CuAHal8p.js";const T=[{id:"HCl",name:"HCl (acid)",color:"#ff7b7b",type:"acid"},{id:"NaOH",name:"NaOH (base)",color:"#7bc8ff",type:"base"},{id:"AgNO3",name:"AgNO₃ (silver nitrate)",color:"#d9d9d9",type:"salt"},{id:"NaCl",name:"NaCl (salt)",color:"#f0f0f0",type:"salt"},{id:"CuSO4",name:"CuSO₄ (copper sulfate)",color:"#4db8ff",type:"salt"},{id:"BaCl2",name:"BaCl₂ (barium chloride)",color:"#ffd27b",type:"salt"}],X={"HCl+NaOH":{resultText:"Neutralization: NaCl (aq) + H₂O (neutral)",color:"#86e08b",effect:"heat"},"AgNO3+NaCl":{resultText:"Precipitate: AgCl (s) formed",color:"#ffffff",effect:"precipitate"},"CuSO4+NaOH":{resultText:"Precipitate: Cu(OH)₂ (s) formed",color:"#3fb0ff",effect:"precipitate"},"AgNO3+HCl":{resultText:"Precipitate: AgCl (s) formed",color:"#ffffff",effect:"precipitate"},"CuSO4+HCl":{resultText:"No major precipitate; solution color shifts",color:"#3aa0ff",effect:"mix"}};function k(d,c,g){return Math.max(c,Math.min(g,d))}function O(d){const c=d.replace("#","");return{r:parseInt(c.slice(0,2),16),g:parseInt(c.slice(2,4),16),b:parseInt(c.slice(4,6),16)}}function Y({r:d,g:c,b:g}){const u=f=>("0"+Math.round(k(f,0,255)).toString(16)).slice(-2);return`#${u(d)}${u(c)}${u(g)}`}function Z(d){let c=0,g=0,u=0,f=0;return d.forEach(m=>{const j=Math.max(0,m.weight||1),v=O(m.color||"#ffffff");c+=v.r*j,g+=v.g*j,u+=v.b*j,f+=j}),f===0?"#a3c2ff":Y({r:c/f,g:g/f,b:u/f})}function K(){const[d,c]=a.useState([]),[g,u]=a.useState(0),[f,m]=a.useState("#a3c2ff"),[j,v]=a.useState([]),[w,_]=a.useState(5),[C,H]=a.useState(!1),[$,B]=a.useState(!1),[q,S]=a.useState([]),[L,A]=a.useState([]),[N,I]=a.useState(0),[z,M]=a.useState(22),R=a.useRef(null),P=a.useRef(performance.now());a.useEffect(()=>{const t=d.reduce((s,o)=>s+(o.volume_ml||0),0);u(t);const r=d.map(s=>({color:T.find(o=>o.id===s.chemId).color,weight:s.volume_ml})),l=Z(r);m(l)},[d]),a.useEffect(()=>{let t=!0;function r(l){if(!t)return;const s=Math.min(.05,(l-P.current)/1e3);P.current=l,S(o=>o.map(n=>({...n,y:n.y-n.vy*s,life:n.life-s*.2})).filter(n=>n.life>0)),A(o=>o.map(n=>({...n,y:n.y-(30+n.speed)*s,life:n.life-s*.6})).filter(n=>n.life>0)),I(o=>Math.max(0,o-s*1.5)),M(o=>Math.max(22,o-s*.5)),R.current=requestAnimationFrame(r)}return R.current=requestAnimationFrame(r),()=>{t=!1,cancelAnimationFrame(R.current)}},[]);function y(t){v(r=>[`${new Date().toLocaleTimeString()}: ${t}`,...r].slice(0,40))}function E(t,r=w,l=1){if($)return;B(!0);const s=24,o=r/s;let n=0;const x=16;y(`Adding ${r} mL of ${t}`),T.find(p=>p.id===t);const h=()=>{n++,c(p=>{const i=[...p],b=i.findIndex(U=>U.chemId===t);return b>=0?i[b]={...i[b],volume_ml:i[b].volume_ml+o}:i.push({chemId:t,volume_ml:o,concentration:l}),i}),n<s?setTimeout(h,x):(B(!1),setTimeout(()=>G(),120))};h()}function V(){c([]),S([]),A([]),v([]),m("#a3c2ff"),u(0),M(22),y("Beaker reset")}function G(){const t=Array.from(new Set(d.map(l=>l.chemId)));let r=!1;for(let l=0;l<t.length;l++)for(let s=l+1;s<t.length;s++){const o=t[l],n=t[s],x=[o,n].sort().join("+"),h=X[x];h&&(r=!0,y(`Reaction detected: ${h.resultText}`),h.effect==="precipitate"?(D(),m(h.color)):h.effect==="heat"?(I(1.4),M(p=>Math.min(80,p+12)),m(h.color)):h.effect==="mix"&&m(h.color),c(p=>p.map(i=>i.chemId===o||i.chemId===n?{...i,volume_ml:Math.max(0,i.volume_ml*.88)}:i).filter(i=>i.volume_ml>.001)))}r||y("No visible reaction detected.")}function D(){const t=Array.from({length:18}).map(()=>({x:40+Math.random()*220,y:260-Math.random()*90,vy:6+Math.random()*20,life:2+Math.random()*2,size:4+Math.random()*6,color:"#ffffff"}));S(r=>[...t,...r].slice(0,300))}function W(t=10){const r=Array.from({length:t}).map(()=>({x:40+Math.random()*220,y:260+Math.random()*20,speed:20+Math.random()*30,life:1+Math.random()*1.6}));A(l=>[...r,...l].slice(0,200))}a.useEffect(()=>{if(!C)return;let t=[{chem:"HCl",vol:10,delay:600},{chem:"NaOH",vol:10,delay:900},{chem:"AgNO3",vol:8,delay:1e3},{chem:"NaCl",vol:8,delay:900}],r=0;y("Auto-mix started");const l=()=>{if(!C||r>=t.length){H(!1),y("Auto-mix finished");return}const s=t[r++];E(s.chem,s.vol),setTimeout(l,s.delay)};return setTimeout(l,400),()=>H(!1)},[C]);function F(){const n=k(g/150,0,1),x=16+Math.round(240*n),h=$?3:0,p=N>0?`0 0 ${12*N}px rgba(255,120,50,${.12*N})`:"none";return e.jsxs("div",{style:{width:280,margin:"0 auto",position:"relative",height:320},children:[e.jsxs("svg",{viewBox:"0 0 280 320",style:{width:"100%",height:"100%"},children:[e.jsxs("defs",{children:[e.jsx("clipPath",{id:"beakerClip",children:e.jsx("rect",{x:28,y:28,rx:"6",ry:"6",width:280-28*2,height:248})}),e.jsxs("linearGradient",{id:"glassGrad",x1:"0",x2:"0",y1:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.06"}),e.jsx("stop",{offset:"100%",stopColor:"#ffffff",stopOpacity:"0.02"})]})]}),e.jsx("rect",{x:28,y:16,width:280-28*2,height:280,rx:"14",fill:"#061021",stroke:"rgba(255,255,255,0.03)",strokeWidth:"2"}),e.jsx("rect",{x:34,y:22,width:280-28*2-12,height:268,rx:"10",fill:"url(#glassGrad)"}),e.jsxs("g",{clipPath:"url(#beakerClip)",children:[e.jsx("rect",{x:28,y:268-x+8,width:280-28*2,height:x+40,fill:f,style:{transition:"fill 450ms linear"}}),e.jsx("g",{style:{transform:`translateX(${h}px)`,transition:"transform 140ms"},children:e.jsx("path",{d:`M28 ${268-x+20}
                        C 68 ${268-x-8},
                          212 ${268-x+48},
                          252 ${268-x+20}
                        L 252 348
                        L 28 348 Z`,fill:O(f)?O(f):f,opacity:"0.08"})}),q.map((i,b)=>e.jsx("circle",{cx:i.x,cy:i.y,r:i.size,fill:i.color,opacity:k(i.life,0,1)},"prec"+b)),L.map((i,b)=>e.jsx("circle",{cx:i.x,cy:i.y,r:Math.max(1,4*i.life),fill:"rgba(255,255,255,0.85)",opacity:k(i.life,0,1)},"bub"+b))]}),e.jsx("rect",{x:22,y:12,width:280-22*2,height:8,rx:"6",fill:"#0d2b3a"}),e.jsx("rect",{x:28,y:284,width:280-28*2,height:8,rx:"4",fill:"rgba(255,255,255,0.02)"}),e.jsx("text",{x:280/2,y:14,textAnchor:"middle",fontSize:"13",fill:"#ffffff",opacity:"0.95",children:"Beaker"}),e.jsxs("text",{x:34,y:314,fontSize:"12",fill:"#ffffff",opacity:"0.85",children:["Vol: ",Math.round(g)," mL"]}),e.jsxs("text",{x:246,y:314,fontSize:"12",fill:"#ffffff",opacity:"0.85",textAnchor:"end",children:["Temp: ",Math.round(z),"°C"]})]}),e.jsx("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,pointerEvents:"none",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("div",{style:{width:160,height:160,borderRadius:80,boxShadow:p,transition:"box-shadow 220ms"}})})]})}return e.jsxs("div",{style:{position:"absolute",inset:"50px 0 0 0",padding:28,boxSizing:"border-box",color:"#fff",overflow:"auto",background:"linear-gradient(180deg,#1b0f2a 0%, #0b0b14 60%)"},children:[e.jsx("h1",{style:{fontSize:36,fontWeight:900,margin:"6px 0 12px 0"},children:"Mixing Lab — Interactive Chemistry"}),e.jsx("p",{style:{marginTop:0,color:"rgba(255,255,255,0.75)"},children:"Click a chemical on the left to pour it into the beaker. Watch for color changes, heat, precipitate or bubbles when reactions occur."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"260px 1fr 360px",gap:22,marginTop:18},children:[e.jsxs("aside",{style:{background:"rgba(255,255,255,0.02)",padding:16,borderRadius:12},children:[e.jsx("h3",{style:{marginTop:0},children:"Chemicals"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:T.map(t=>e.jsxs("button",{onClick:()=>{E(t.id,w,1),(t.type==="acid"||t.type==="base")&&W(4)},style:{display:"flex",alignItems:"center",gap:12,padding:"10px 12px",background:"rgba(255,255,255,0.03)",borderRadius:10,border:"1px solid rgba(255,255,255,0.03)",cursor:"pointer",color:"#fff"},children:[e.jsx("div",{style:{width:36,height:28,borderRadius:6,background:t.color,border:"1px solid rgba(0,0,0,0.25)"}}),e.jsxs("div",{style:{textAlign:"left",flex:1},children:[e.jsx("div",{style:{fontWeight:700},children:t.id}),e.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.75)"},children:t.name})]}),e.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.8)"},children:" "})]},t.id))}),e.jsxs("div",{style:{marginTop:18},children:[e.jsxs("label",{style:{display:"block",marginBottom:6},children:["Drop volume: ",w," mL"]}),e.jsx("input",{type:"range",min:"1",max:"25",value:w,onChange:t=>_(Number(t.target.value)),style:{width:"100%"}})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{onClick:()=>H(t=>!t),style:{flex:1,padding:"10px",background:C?"#f59e0b":"#6366f1",border:"none",color:"#fff",borderRadius:10,fontWeight:800},children:C?"Stop Auto":"Auto-mix"}),e.jsx("button",{onClick:V,style:{flex:1,padding:"10px",background:"#ef4444",border:"none",color:"#fff",borderRadius:10,fontWeight:800},children:"Reset"})]})]}),e.jsxs("main",{style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04))",padding:18,borderRadius:12},children:[e.jsxs("div",{style:{display:"flex",gap:18},children:[e.jsx("div",{style:{flex:1},children:e.jsx(F,{})}),e.jsxs("div",{style:{width:220,color:"rgba(255,255,255,0.95)"},children:[e.jsx("h3",{style:{marginTop:4},children:"Readouts"}),e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"Total volume:"})," ",Math.round(g)," mL"]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"Liquid color:"})," ",e.jsx("span",{style:{display:"inline-block",width:16,height:12,verticalAlign:"middle",marginLeft:8,background:f,borderRadius:3}})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"Temp:"})," ",Math.round(z)," °C"]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("h4",{style:{margin:0},children:"Contents"}),e.jsxs("div",{style:{marginTop:8},children:[d.length===0&&e.jsx("div",{style:{color:"rgba(255,255,255,0.6)"},children:"Beaker empty"}),d.map((t,r)=>(T.find(l=>l.id===t.chemId),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px dashed rgba(255,255,255,0.02)"},children:[e.jsx("div",{children:t.chemId}),e.jsxs("div",{style:{color:"rgba(255,255,255,0.8)"},children:[Math.round(t.volume_ml)," mL"]})]},r)))]})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("button",{onClick:()=>{W(12),y("Agitated beaker (shaken)")},style:{padding:"8px 12px",borderRadius:8,border:"none",background:"#10b981",color:"#fff",fontWeight:700},children:"Agitate (shake)"}),e.jsx("button",{onClick:()=>{M(t=>t+8),y("Heated beaker")},style:{padding:"8px 12px",borderRadius:8,border:"none",background:"#f59e0b",color:"#000",marginLeft:8,fontWeight:700},children:"Heat"})]})]})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h4",{style:{marginBottom:6},children:"Activity log"}),e.jsxs("div",{style:{maxHeight:160,overflowY:"auto",padding:12,background:"rgba(255,255,255,0.01)",borderRadius:8},children:[j.length===0&&e.jsx("div",{style:{color:"rgba(255,255,255,0.6)"},children:"No actions yet."}),j.map((t,r)=>e.jsx("div",{style:{fontSize:13,color:"rgba(255,255,255,0.85)",marginBottom:6},children:t},r))]})]})]}),e.jsxs("aside",{style:{background:"rgba(255,255,255,0.02)",padding:18,borderRadius:12},children:[e.jsx("h3",{style:{marginTop:0},children:"Reaction Inspector"}),e.jsxs("div",{style:{color:"rgba(255,255,255,0.9)"},children:[e.jsx("div",{style:{marginBottom:10},children:e.jsx("strong",{children:"Try combinations:"})}),e.jsxs("ul",{style:{paddingLeft:18},children:[e.jsx("li",{children:"AgNO₃ + NaCl → white AgCl(s)"}),e.jsx("li",{children:"CuSO₄ + NaOH → blue Cu(OH)₂(s)"}),e.jsx("li",{children:"HCl + NaOH → neutralization (salt + water)"})]})]}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.04)",marginTop:12,paddingTop:12},children:[e.jsx("h4",{style:{margin:0},children:"Status"}),e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Precipitates:"})," ",q.length]}),e.jsxs("div",{style:{marginTop:6},children:[e.jsx("strong",{children:"Bubbles:"})," ",L.length]})]})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h4",{style:{marginBottom:6},children:"Notes"}),e.jsxs("div",{style:{fontSize:13,color:"rgba(255,255,255,0.85)"},children:["- Real chemistry involves stoichiometry and solubility rules. This simulation simplifies those rules to highlight learning moments.",e.jsx("br",{}),"- Use Heat and Agitate to speed up or reveal precipitates."]})]})]})]})]})}export{K as default};
