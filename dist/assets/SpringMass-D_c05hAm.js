import{r as l,j as n}from"./index-CuAHal8p.js";function Gt(){const[y,Tt]=l.useState(1),[j,Ft]=l.useState(20),[E,kt]=l.useState(.5),[v,Et]=l.useState(-.4),[m,wt]=l.useState(0),[N,Rt]=l.useState(0),[H,Pt]=l.useState(2),[P,Wt]=l.useState(.012),[J,Ct]=l.useState(1),[$,tt]=l.useState(!1),[dt,Jt]=l.useState(!0),f=l.useRef({t:0,x:v,v:m}),et=l.useRef(null),D=l.useRef(null),nt=l.useRef(null),[T,G]=l.useState([]),xt=4e3,st=Math.sqrt(j/y),zt=st/(2*Math.PI),ut=E/(2*Math.sqrt(j*y));function A(e,t){const s=.5*y*t*t,o=.5*j*e*e;return{KE:s,PE:o,E:s+o}}function Y(e,t){const s=N*Math.sin(H*t),o=(-j*e.x-E*e.v+s)/y;return{xdot:e.v,vdot:o}}function ft(e,t,s){const o=Y(e,t),a={x:e.x+.5*s*o.xdot,v:e.v+.5*s*o.vdot},c=Y(a,t+.5*s),x={x:e.x+.5*s*c.xdot,v:e.v+.5*s*c.vdot},i=Y(x,t+.5*s),d={x:e.x+s*i.xdot,v:e.v+s*i.vdot},r=Y(d,t+s),p=e.x+s/6*(o.xdot+2*c.xdot+2*i.xdot+r.xdot),L=e.v+s/6*(o.vdot+2*c.vdot+2*i.vdot+r.vdot);return{x:p,v:L}}function ht(e={}){const t=e.x??v,s=e.v??m;f.current={t:0,x:t,v:s},G([{t:0,x:t,v:s,...A(t,s)}])}l.useEffect(()=>{ht({x:v,v:m})},[]),l.useEffect(()=>{const e=nt.current;if(!e)return;function t(){const s=Math.max(720,Math.min(window.innerWidth*.68,1300)),o=Math.max(420,Math.min(window.innerHeight-72-220,900));e.width=Math.floor(s),e.height=Math.floor(o),O()}return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[y,j,E,dt,N,H]),l.useEffect(()=>{function e(t){D.current||(D.current=t);const s=t-D.current;D.current=t;const o=s/1e3*J;if($&&o>1e-9){let a=o;const c=.05;for(a>.25&&(a=.25);a>1e-9;){const x=Math.min(P,a,c),i=f.current,d=ft({x:i.x,v:i.v},i.t,x),r=i.t+x;f.current={t:r,x:d.x,v:d.v},a-=x}G(x=>{const i=f.current,d=A(i.x,i.v),r=x.concat({t:i.t,x:i.x,v:i.v,...d});return r.length>xt&&r.shift(),r})}O(),et.current=requestAnimationFrame(e)}return et.current=requestAnimationFrame(e),()=>cancelAnimationFrame(et.current)},[$,P,J,N,H,E,y,j]);function O(){const e=nt.current;if(!e)return;const t=e.getContext("2d"),s=e.width,o=e.height;t.clearRect(0,0,s,o),t.fillStyle="#071122",t.fillRect(0,0,s,o);const a=Math.floor(s*.06),c=Math.floor(s*.06),x=s-a-c,i=o-22,d=a,r=8,p=d+32,L=p+8,ot=d+Math.floor(x*.15),_=Math.floor(x*.6),b=Math.floor(r+i*.45);t.fillStyle="rgba(255,255,255,0.02)",V(t,d,r,x,i,12),t.fill();const W=Math.max(80,Math.min(210,(_-120)/1.6)),C=ot+Math.floor(_/2),At=f.current,X=C+At.x*W;t.fillStyle="#0b1228",t.fillRect(p-12,r+12,16,i-24),t.strokeStyle="rgba(255,255,255,0.03)",t.lineWidth=1;for(let u=r+20;u<r+i-20;u+=10)t.beginPath(),t.moveTo(p-12+2,u),t.lineTo(p-12+12,u+6),t.stroke();const mt=X-42;Ht(t,L,mt,b,14,8,"#60a5fa"),t.fillStyle="rgba(255,255,255,0.04)",t.fillRect(mt-6,b-40,12,80);const Q=84,S=64;V(t,X-Q/2,b-S/2,Q,S,8),t.fillStyle="#f59e0b",t.fill();const it=t.createRadialGradient(X,b+S/2+6,1,X,b+S/2+6,Q);it.addColorStop(0,"rgba(0,0,0,0.45)"),it.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=it,t.beginPath(),t.ellipse(X,b+S/2+12,Q*.6,18,0,0,Math.PI*2),t.fill(),t.strokeStyle="rgba(255,255,255,0.04)",t.setLineDash([4,6]),t.beginPath(),t.moveTo(C,r+12),t.lineTo(C,r+i-12),t.stroke(),t.setLineDash([]),t.fillStyle="rgba(255,255,255,0.06)",t.font="12px Inter, system-ui, Arial",t.fillText("0 m",C-14,b-S/2-12),t.fillText(" +1 m",C+W-22,b-S/2-12),t.fillText(" -1 m",C-W-24,b-S/2-12);const q=Math.min(380,Math.floor(x*.36)),U=Math.floor(i*.36),rt=d+x-q-18,lt=r+12;t.fillStyle="rgba(255,255,255,0.02)",V(t,rt,lt,q,U,8),t.fill();const z=T.slice(-Math.floor(q));if(z.length>2){const u=z[0].t,F=z[z.length-1].t||u+1,B=Math.max(1e-6,F-u);t.beginPath();for(let g=0;g<z.length;g++){const R=z[g],K=rt+6+(R.t-u)/B*(q-12),Z=lt+U/2-R.x*W*(U/2-8)/(W*1.6);g===0?t.moveTo(K,Z):t.lineTo(K,Z)}t.strokeStyle="#60a5fa",t.lineWidth=2,t.stroke()}const at=q,ct=Math.floor(i*.2),pt=rt,bt=lt+U+12;t.fillStyle="rgba(255,255,255,0.02)",V(t,pt,bt,at,ct,8),t.fill();const w=T.slice(-Math.floor(at));if(w.length>2){const u=w[0].t,F=w[w.length-1].t||u+1,B=Math.max(1e-6,F-u);t.beginPath();for(let g=0;g<w.length;g++){const R=w[g],K=pt+6+(R.t-u)/B*(at-12),Z=Math.max(...w.map(Lt=>Lt.E),1e-6),Mt=bt+ct-R.E/Z*(ct-12);g===0?t.moveTo(K,Mt):t.lineTo(K,Mt)}t.strokeStyle="#fb7185",t.lineWidth=2,t.stroke()}t.font="13px Inter, system-ui, Arial",t.fillStyle="rgba(255,255,255,0.85)";const It=f.current.t,yt=f.current.x,jt=f.current.v,St=A(yt,jt);if(t.fillText(`t = ${It.toFixed(2)} s`,d+14,r+28),t.fillText(`x = ${yt.toFixed(2)} m`,d+14,r+48),t.fillText(`v = ${jt.toFixed(2)} m/s`,d+14,r+68),t.fillText(`KE = ${St.KE.toFixed(2)} J, PE = ${St.PE.toFixed(2)} J`,d+14,r+88),dt&&T.length>6){const u=T.slice(-120);for(let F=0;F<u.length;F+=4){const B=u[F],g=Nt(d,x)+B.x*W,R=b+S/2+6;t.fillStyle=`rgba(99,102,241,${.05+F/u.length*.6})`,t.fillRect(g-2,R-2,4,4)}}}function Nt(e,t){return e+Math.floor(t*.15)+Math.floor(t*.6/2)}function Ht(e,t,s,o,a=12,c=8,x="#60a5fa"){const i=Math.max(10,s-t),d=Math.max(6,Math.floor(a*i/120));e.beginPath(),e.moveTo(t,o);for(let r=1;r<=d;r++){const p=r/d,L=t+p*(s-t),ot=p*Math.PI*a,_=o+Math.sin(ot)*c*Math.sin((1-p)*Math.PI*.5);e.lineTo(L,_)}e.strokeStyle=x,e.lineWidth=3,e.stroke()}function V(e,t,s,o,a,c){e.beginPath(),e.moveTo(t+c,s),e.arcTo(t+o,s,t+o,s+a,c),e.arcTo(t+o,s+a,t,s+a,c),e.arcTo(t,s+a,t,s,c),e.arcTo(t,s,t+o,s,c),e.closePath()}function gt(){tt(e=>{const t=!e;return t&&(D.current=null),t})}function Dt(){const e=f.current,t=ft({x:e.x,v:e.v},e.t,P);f.current={t:e.t+P,x:t.x,v:t.v},G(s=>{const o=f.current,a=A(o.x,o.v),c=s.concat({t:o.t,x:o.x,v:o.v,...a});return c.length>xt&&c.shift(),c}),O()}function vt(){tt(!1),ht({x:v,v:m})}l.useEffect(()=>{$||(f.current.x=v,f.current.v=m,G([{t:0,x:v,v:m,...A(v,m)}]),O())},[v,m,y,j,E]);const I=f.current,h=T.length?T[T.length-1]:null;return l.useEffect(()=>{function e(t){t.code==="Space"?(t.preventDefault(),gt()):t.key.toLowerCase()==="r"?vt():t.key.toLowerCase()==="p"&&tt(!1)}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),n.jsxs("div",{style:{position:"absolute",top:50,left:0,right:0,bottom:0,overflow:"hidden",color:"#fff",background:"linear-gradient(180deg,#0b1220,#1b0922)",padding:18,boxSizing:"border-box"},children:[n.jsxs("div",{style:{marginBottom:10},children:[n.jsx("h2",{style:{margin:0,fontSize:32,fontWeight:900},children:"Spring–Mass Oscillator"}),n.jsx("div",{style:{fontSize:14,color:"rgba(255,255,255,0.78)",marginTop:6},children:"Advanced oscillator with damping and driving. Compare analytic & simulated behavior."})]}),n.jsxs("div",{style:{display:"flex",gap:18,flexWrap:"wrap",alignItems:"center",marginBottom:12,fontSize:13},children:[n.jsxs("div",{children:["t: ",I.t.toFixed(2)," s"]}),n.jsxs("div",{children:["x: ",I.x.toFixed(2)," m"]}),n.jsxs("div",{children:["v: ",I.v.toFixed(2)," m/s"]}),n.jsxs("div",{children:["KE: ",h?h.KE.toFixed(2):"—"," J"]}),n.jsxs("div",{children:["PE: ",h?h.PE.toFixed(2):"—"," J"]}),n.jsxs("div",{children:["Total: ",h?h.E.toFixed(2):"—"," J"]}),n.jsxs("div",{children:["ω₀: ",st.toFixed(2)," rad/s"]}),n.jsxs("div",{children:["ζ: ",ut.toFixed(3)]}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[n.jsx("button",{onClick:gt,style:Xt,children:$?"Pause (P)":"Run (Space)"}),n.jsx("button",{onClick:Dt,style:qt,children:"Step"}),n.jsx("button",{onClick:vt,style:Bt,children:"Reset"})]})]}),n.jsxs("div",{style:{display:"flex",gap:18,height:"calc(100% - 170px)"},children:[n.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:12,background:"linear-gradient(145deg,#0f1724,#111827)",borderRadius:16,boxShadow:"0 12px 40px rgba(2,6,23,0.6), inset 0 4px 18px rgba(255,255,255,0.02)",padding:16},children:[n.jsx("div",{style:{flex:1,borderRadius:12,overflow:"hidden",background:"#071022"},children:n.jsx("canvas",{ref:nt,style:{width:"100%",height:"100%",display:"block"}})}),n.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[n.jsxs("div",{style:k,children:[n.jsxs("label",{style:M,children:["Mass: ",y.toFixed(2)]}),n.jsx("input",{type:"range",min:.1,max:8,step:.01,value:y,onChange:e=>Tt(Number(e.target.value))})]}),n.jsxs("div",{style:k,children:[n.jsxs("label",{style:M,children:["k (N/m): ",j.toFixed(1)]}),n.jsx("input",{type:"range",min:1,max:200,step:.1,value:j,onChange:e=>Ft(Number(e.target.value))})]}),n.jsxs("div",{style:k,children:[n.jsxs("label",{style:M,children:["Damping: ",E.toFixed(2)]}),n.jsx("input",{type:"range",min:0,max:6,step:.01,value:E,onChange:e=>kt(Number(e.target.value))})]}),n.jsxs("div",{style:{...k,minWidth:220},children:[n.jsxs("label",{style:M,children:["Initial x: ",v.toFixed(2)," m"]}),n.jsx("input",{type:"range",min:-1.5,max:1.5,step:.01,value:v,onChange:e=>Et(Number(e.target.value))})]}),n.jsxs("div",{style:{...k,minWidth:220},children:[n.jsxs("label",{style:M,children:["Initial v: ",m.toFixed(2)," m/s"]}),n.jsx("input",{type:"range",min:-6,max:6,step:.01,value:m,onChange:e=>wt(Number(e.target.value))})]}),n.jsxs("div",{style:{...k,minWidth:260},children:[n.jsxs("label",{style:M,children:["Drive amp: ",N.toFixed(2)," N"]}),n.jsx("input",{type:"range",min:0,max:20,step:.1,value:N,onChange:e=>Rt(Number(e.target.value))}),n.jsxs("label",{style:{...M,marginTop:6},children:["Drive freq: ",H.toFixed(2)," rad/s"]}),n.jsx("input",{type:"range",min:.2,max:10,step:.01,value:H,onChange:e=>Pt(Number(e.target.value))})]}),n.jsxs("div",{style:k,children:[n.jsxs("label",{style:M,children:["Time step dt: ",P,"s"]}),n.jsx("input",{type:"range",min:.002,max:.04,step:.001,value:P,onChange:e=>Wt(Number(e.target.value))})]}),n.jsxs("div",{style:k,children:[n.jsxs("label",{style:M,children:["Time scale: ",J.toFixed(2),"x"]}),n.jsx("input",{type:"range",min:.1,max:3,step:.05,value:J,onChange:e=>Ct(Number(e.target.value))})]})]})]}),n.jsx("aside",{style:{width:320},children:n.jsxs("div",{style:{background:"rgba(17,24,39,0.95)",borderRadius:16,padding:16,height:"100%",boxSizing:"border-box",boxShadow:"0 6px 20px rgba(0,0,0,0.5)"},children:[n.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"Measurements"}),n.jsxs("div",{style:{marginTop:6},children:["Displacement: ",I.x.toFixed(3)," m"]}),n.jsxs("div",{children:["Velocity: ",I.v.toFixed(3)," m/s"]}),n.jsxs("div",{children:["Natural ω₀: ",st.toFixed(3)," rad/s"]}),n.jsxs("div",{children:["Natural f₀: ",zt.toFixed(3)," Hz"]}),n.jsxs("div",{children:["Damping ratio ζ: ",ut.toFixed(3)]}),n.jsx("div",{style:{marginTop:8,fontWeight:700},children:"Energy (J):"}),n.jsxs("div",{style:{marginTop:4},children:[n.jsxs("div",{children:["KE: ",h?h.KE.toFixed(3):"—"]}),n.jsxs("div",{children:["PE: ",h?h.PE.toFixed(3):"—"]}),n.jsxs("div",{children:["Total: ",h?h.E.toFixed(3):"—"]})]}),n.jsx("hr",{style:{border:"none",height:1,background:"rgba(255,255,255,0.04)",margin:"10px 0"}}),n.jsx("div",{style:{fontWeight:800},children:"History (last values)"}),n.jsx("div",{style:{fontSize:13,color:"rgba(255,255,255,0.78)",marginTop:8,height:220,overflow:"auto"},children:T.slice(-30).reverse().map((e,t)=>n.jsxs("div",{style:{marginBottom:6,fontSize:12},children:["t:",e.t.toFixed(2),"s • x:",e.x.toFixed(3)," • v:",e.v.toFixed(2)]},t))})]})})]})]})}const Xt={background:"linear-gradient(90deg,#7c3aed,#a78bfa)",border:"none",color:"#fff",padding:"8px 12px",borderRadius:8,fontWeight:800,cursor:"pointer",fontSize:13},qt={background:"rgba(255,255,255,0.04)",border:"none",color:"#fff",padding:"8px 10px",borderRadius:8,cursor:"pointer",fontSize:13},Bt={background:"linear-gradient(90deg,#ef4444,#f97316)",border:"none",color:"#fff",padding:"8px 10px",borderRadius:8,cursor:"pointer",fontSize:13},k={background:"rgba(255,255,255,0.02)",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.03)",minWidth:140,display:"flex",flexDirection:"column",gap:6},M={fontSize:12,fontWeight:700,color:"rgba(255,255,255,0.9)"};export{Gt as default};
